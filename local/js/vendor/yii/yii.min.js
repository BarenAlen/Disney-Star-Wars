/*
 Copyright (c) 2008 Yii Software LLC
 @license http://www.yiiframework.com/license/
 @author Qiang Xue <qiang.xue@gmail.com>
 @since 2.0
*/
window.yii=function(c){function q(){c.ajaxPrefilter(function(a,d,b){!a.crossDomain&&f.getCsrfParam()&&b.setRequestHeader("X-CSRF-Token",f.getCsrfToken())});f.refreshCsrfToken()}function u(){c(document).ajaxComplete(function(a,d){var b=d&&d.getResponseHeader("X-Redirect");b&&window.location.assign(b)})}function v(){var a={};c("script[src]").each(function(){var d=k(this.src);a[d]=!0});c.ajaxPrefilter("script",function(d,b,c){if("jsonp"!=d.dataType){d=k(d.url);b=!0===a[d]&&!m(d);var e=void 0!==a[d]&&
!0===a[d].xhrDone;if(b||e)c.abort();else{if(void 0===a[d]||!0===a[d])a[d]={xhrList:[],xhrDone:!1};c.done(function(b,d,c){if(!0!==a[c.yiiUrl].xhrDone){a[c.yiiUrl].xhrDone=!0;b=0;for(d=a[c.yiiUrl].xhrList.length;b<d;b++){var e=a[c.yiiUrl].xhrList[b];e&&e.readyState!==XMLHttpRequest.DONE&&e.abort()}a[c.yiiUrl]=!0}}).fail(function(b,d){if("abort"!==d){delete a[b.yiiUrl].xhrList[b.yiiIndex];for(var c=!0,e=0,f=a[b.yiiUrl].xhrList.length;e<f;e++)a[b.yiiUrl].xhrList[e]&&(c=!1);c&&delete a[b.yiiUrl]}});c.yiiIndex=
a[d].xhrList.length;c.yiiUrl=d;a[d].xhrList[c.yiiIndex]=c}}});c(document).ajaxComplete(function(){var a=[];c("link[rel=stylesheet]").each(function(){var b=k(this.href);m(b)||(-1===c.inArray(b,a)?a.push(b):c(this).remove())})})}function w(){var a=function(a){var b=c(this),d=b.data("method"),e=b.data("confirm"),g=b.data("form");if(void 0===d&&void 0===e&&void 0===g)return!0;void 0!==e?c.proxy(f.confirm,this)(e,function(){f.handleAction(b,a)}):f.handleAction(b,a);a.stopImmediatePropagation();return!1};
c(document).on("click.yii",f.clickableSelector,a).on("change.yii",f.changeableSelector,a)}function m(a){for(var c=0;c<f.reloadableScripts.length;c++){var b=k(f.reloadableScripts[c]);if(!0===(new RegExp("^"+b.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").split("\\*").join(".+")+"$")).test(a))return!0}return!1}function k(a){return"/"===a.charAt(0)?f.getBaseCurrentUrl()+a:a}var f={reloadableScripts:[],clickableSelector:'a, button, input[type="submit"], input[type="button"], input[type="reset"], input[type="image"]',
changeableSelector:"select, input, textarea",getCsrfParam:function(){return c("meta[name=csrf-param]").attr("content")},getCsrfToken:function(){return c("meta[name=csrf-token]").attr("content")},setCsrfToken:function(a,d){c("meta[name=csrf-param]").attr("content",a);c("meta[name=csrf-token]").attr("content",d)},refreshCsrfToken:function(){var a=f.getCsrfToken();a&&c('form input[name="'+f.getCsrfParam()+'"]').val(a)},confirm:function(a,c,b){window.confirm(a)?!c||c():!b||b()},handleAction:function(a,
d){var b=a.attr("data-form")?c("#"+a.attr("data-form")):a.closest("form"),h=!a.data("method")&&b?b.attr("method"):a.data("method"),e=a.attr("href"),g=e&&"#"!==e,n=a.data("params"),k=n&&c.isPlainObject(n),l=a.data("pjax");l=void 0!==l&&0!==l&&c.support.pjax;var p={};if(l){var r=a.data("pjax-container")||a.closest("[data-pjax-container]");r.length||(r=c("body"));p={container:r,push:!!a.data("pjax-push-state"),replace:!!a.data("pjax-replace-state"),scrollTo:a.data("pjax-scrollto"),pushRedirect:a.data("pjax-push-redirect"),
replaceRedirect:a.data("pjax-replace-redirect"),skipOuterContainers:a.data("pjax-skip-outer-containers"),timeout:a.data("pjax-timeout"),originalEvent:d,originalTarget:a}}if(void 0===h)if(g)l?c.pjax.click(d,p):window.location.assign(e);else{if(a.is(":submit")&&b.length){if(l)b.on("submit",function(a){c.pjax.submit(a,p)});b.trigger("submit")}}else{var m=!b.length;if(m)g||(e=f.getCurrentUrl()),b=c("<form/>",{method:h,action:e}),(e=a.attr("target"))&&b.attr("target",e),/(get|post)/i.test(h)||(b.append(c("<input/>",
{name:"_method",value:h,type:"hidden"})),h="post",b.attr("method",h)),/post/i.test(h)&&(h=f.getCsrfParam())&&b.append(c("<input/>",{name:h,value:f.getCsrfToken(),type:"hidden"})),b.hide().appendTo("body");else{var q=b.attr("method");b.attr("method",h);if(g){var t=b.attr("action");b.attr("action",e)}}if(h=b.data("yiiActiveForm"))h.submitObject=a;k&&c.each(n,function(a,d){b.append(c("<input/>").attr({name:a,value:d,type:"hidden"}))});if(l)b.on("submit",function(a){c.pjax.submit(a,p)});b.trigger("submit");
c.when(b.data("yiiSubmitFinalizePromise")).then(function(){m?b.remove():(void 0!==t&&b.attr("action",t),b.attr("method",q),k&&c.each(n,function(a){c('input[name="'+a+'"]',b).remove()}))})}},getQueryParams:function(a){var d=a.indexOf("?");if(0>d)return{};a=c.grep(a.substring(d+1).split("#")[0].split("&"),function(a){return""!==a});d={};for(var b=0,f=a.length;b<f;b++){var e=a[b].split("="),g=decodeURIComponent(e[0].replace(/\+/g,"%20"));e=decodeURIComponent(e[1].replace(/\+/g,"%20"));g.length&&(void 0===
d[g]?d[g]=e||"":(c.isArray(d[g])||(d[g]=[d[g]]),d[g].push(e||"")))}return d},initModule:function(a){if(void 0===a.isActive||a.isActive)c.isFunction(a.init)&&a.init(),c.each(a,function(){c.isPlainObject(this)&&f.initModule(this)})},init:function(){q();u();v();w()},getBaseCurrentUrl:function(){return window.location.protocol+"//"+window.location.host},getCurrentUrl:function(){return window.location.href}};return f}(window.jQuery);window.jQuery(function(){window.yii.initModule(window.yii)});